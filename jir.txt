# Switch logic based on operation
switch ($Operation) {
    'create' {
        if (!$PSBoundParameters['DurationInDays']) {
            throw "DurationInDays is required for the 'create' operation."
        }
        Write-Output "Creating with a duration of $DurationInDays days."
    }
    'delete' {
        if ($PSBoundParameters['DurationInDays']) {
            throw "DurationInDays is not allowed for the 'delete' operation."
        }
        Write-Output "Deleting. Duration is not required."
    }
}
